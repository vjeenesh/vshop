<%- include('../includes/head.ejs') %>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
</head>
<body>
    <%- include('../includes/navigation.ejs') %>
    <main>
        <h1>My Orders</h1>
        <% if(orders.length == 0) { %>
            <h2>Nothing here!</h2>
        <% } else { %>
            <div class="table-responsive-md">
                <table class="table table-primary table-hover">
                    <thead>
                        <tr class="text-center">
                        <th scope="col">#Order</th>
                        <th scope="col">UserName</th>
                        <th scope="col">Product Name</th>
                        <th scope="col">Quantity</th>
                        <th scope="col">Total</th>
                        <th scope="col">Invoice</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% orders.forEach(order => { %>
                            <% order.products.forEach(product => { %>
                                <tr class="text-center">
                                    <th scope="row">#<%= order._id %></th>
                                    <td><%= order.userData.username %></td>
                                    <td><%= product.productData.productTitle %></td>
                                    <td><%= product.quantity %></td>
                                    <td>$<%= product.quantity * product.productData.productPrice %></td>
                                    <td><a href="/orders/<%= order._id %>" target="_blank"><i class="bi bi-download"></i></a></td>
                                </tr>
                            <% }) %>
                        <% }) %>    
                    </tbody>
                </table>
            </div>
        <% } %>

    </main>
    <%- include('../includes/end.ejs') %>
